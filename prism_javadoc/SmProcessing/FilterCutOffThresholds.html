<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_212) on Tue Nov 12 13:26:26 PST 2019 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>FilterCutOffThresholds (PRISM javadoc)</title>
<meta name="date" content="2019-11-12">
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
<script type="text/javascript" src="../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="FilterCutOffThresholds (PRISM javadoc)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/FilterCutOffThresholds.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-files/index-1.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../SmProcessing/FilterAndIntegrateProcess.html" title="class in SmProcessing"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../SmProcessing/QCcheck.html" title="class in SmProcessing"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../index.html?SmProcessing/FilterCutOffThresholds.html" target="_top">Frames</a></li>
<li><a href="FilterCutOffThresholds.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">SmProcessing</div>
<h2 title="Class FilterCutOffThresholds" class="title">Class FilterCutOffThresholds</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>SmProcessing.FilterCutOffThresholds</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">FilterCutOffThresholds</span>
extends java.lang.Object</pre>
<div class="block">This class chooses the Butterworth filter cutoff thresholds to use, based on
 either the magnitude of the earthquake or the frequency content of the seismic
 signal.  
 
 When based on earthquake magnitude, it also determines which magnitude from
 the COSMOS header to use, based on which value is defined in the header.  The
 order of selection is moment, local, surface, and other.  The header values
 are determined to be defined if they are not equal to the Real Header NoData
 value and are non-negative.
 
 When based on frequency content, the Fourier amplitude spectra for noise and 
 signal are calculated and then smoothed.  The intersection points of the smoothed
 spectra within low-pass and high-pass frequency regions are searched to determine
 the appropriate corner frequencies to be used for bandpass filtering.
 
 The high-pass region is defined between 0.1 Hz and 1.0 Hz.  If no intersection
 is found, the default value of 0.1 Hz is used.
 
 The low-pass region is defined between the characteristic frequency of the
 recording instrument (fc) (often 25 Hz) and Nyquist (half of sampling frequency
 of the waveform data).  If no intersection point is detected, 80% of Nyquist
 is used as the low-pass corner.
 
 Based on Matlab code written by Dr. Erol Kalkan, P.E. (kalkan76@gmail.com)
 URL: www.erolkalkan.com
 Revision: 1.0.7  Date: 2019/02/11</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../SmProcessing/FilterCutOffThresholds.html#FilterCutOffThresholds--">FilterCutOffThresholds</a></span>()</code>
<div class="block">Constructor just initializes values.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../SmProcessing/FilterCutOffThresholds.html#findFreqThresholds-double:A-int-double-double-">findFreqThresholds</a></span>(double[]&nbsp;array,
                  int&nbsp;eonset,
                  double&nbsp;current_samprate,
                  double&nbsp;orig_samprate)</code>
<div class="block">Looks at the smoothed frequency content for the acceleration array
 and uses this to determine the filter cutoff thresholds.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>org.apache.commons.math3.linear.RealMatrix</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../SmProcessing/FilterCutOffThresholds.html#findIntersection-double:A-double:A-double:A-double:A-">findIntersection</a></span>(double[]&nbsp;x1,
                double[]&nbsp;y1,
                double[]&nbsp;x2,
                double[]&nbsp;y2)</code>
<div class="block">Finds the intersection of 2 curves.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../SmProcessing/FilterCutOffThresholds.html#getHighCutOff--">getHighCutOff</a></span>()</code>
<div class="block">Getter for the filter high cutoff threshold</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../SmProcessing/FilterCutOffThresholds.html#getLowCutOff--">getLowCutOff</a></span>()</code>
<div class="block">Getter for the filter low cutoff threshold</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../SmProcessing/FilterCutOffThresholds.html#getMagnitude--">getMagnitude</a></span>()</code>
<div class="block">Getter for the earthquake magnitude used for selection</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code><a href="../SmConstants/VFileConstants.MagnitudeType.html" title="enum in SmConstants">VFileConstants.MagnitudeType</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../SmProcessing/FilterCutOffThresholds.html#SelectMagnitude-double-double-double-double-double-">SelectMagnitude</a></span>(double&nbsp;mm,
               double&nbsp;lm,
               double&nbsp;sm,
               double&nbsp;om,
               double&nbsp;noval)</code>
<div class="block">Determines the high and low filter cutoff thresholds to use based on
 the earthquake magnitude.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code><a href="../SmConstants/VFileConstants.MagnitudeType.html" title="enum in SmConstants">VFileConstants.MagnitudeType</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../SmProcessing/FilterCutOffThresholds.html#SelectMagThresholds-SmConstants.VFileConstants.MagnitudeType-double-double-">SelectMagThresholds</a></span>(<a href="../SmConstants/VFileConstants.MagnitudeType.html" title="enum in SmConstants">VFileConstants.MagnitudeType</a>&nbsp;intype,
                   double&nbsp;mag,
                   double&nbsp;orig_samprate)</code>
<div class="block">Determines the high and low filter cutoff thresholds to use based on
 the earthquake magnitude.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>double[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../SmProcessing/FilterCutOffThresholds.html#smoothFAS-double:A-">smoothFAS</a></span>(double[]&nbsp;FASamps)</code>
<div class="block">Uses the Konno-Ohmachi window function to smooth the Fourier amplitude
 spectra.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="FilterCutOffThresholds--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>FilterCutOffThresholds</h4>
<pre>public&nbsp;FilterCutOffThresholds()</pre>
<div class="block">Constructor just initializes values.  The sample rate is used during the magnitude
 approach to screen for an appropriate sample rate for the given EQ magnitude.
 For the frequency approach, it is used for creation of an array of frequency values.</div>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="SelectMagnitude-double-double-double-double-double-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SelectMagnitude</h4>
<pre>public&nbsp;<a href="../SmConstants/VFileConstants.MagnitudeType.html" title="enum in SmConstants">VFileConstants.MagnitudeType</a>&nbsp;SelectMagnitude(double&nbsp;mm,
                                                    double&nbsp;lm,
                                                    double&nbsp;sm,
                                                    double&nbsp;om,
                                                    double&nbsp;noval)</pre>
<div class="block">Determines the high and low filter cutoff thresholds to use based on
 the earthquake magnitude.  There are 4 earthquake values that may be
 defined in the COSMOS header, and the order for selection is moment,
 local, surface, and other.  If no earthquake parameters are defined, the
 return value will be set to INVALID.  Earthquake parameters are considered
 valid if they are greater than zero and not equal to the COSMOS nodata
 value, given in the noval parameter.  A typical COSMOS nodata value is
 -999.99.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>mm</code> - moment magnitude from the COSMOS header</dd>
<dd><code>lm</code> - local magnitude from the COSMOS header</dd>
<dd><code>sm</code> - surface magnitude from the COSMOS header</dd>
<dd><code>om</code> - other magnitude from the COSMOS header</dd>
<dd><code>noval</code> - No Data value for the COSMOS real header</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the magnitude type that would be used to select the high and low 
 cutoff values, or INVALID if no earthquake values have been defined.</dd>
</dl>
</li>
</ul>
<a name="SelectMagThresholds-SmConstants.VFileConstants.MagnitudeType-double-double-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SelectMagThresholds</h4>
<pre>public&nbsp;<a href="../SmConstants/VFileConstants.MagnitudeType.html" title="enum in SmConstants">VFileConstants.MagnitudeType</a>&nbsp;SelectMagThresholds(<a href="../SmConstants/VFileConstants.MagnitudeType.html" title="enum in SmConstants">VFileConstants.MagnitudeType</a>&nbsp;intype,
                                                        double&nbsp;mag,
                                                        double&nbsp;orig_samprate)</pre>
<div class="block">Determines the high and low filter cutoff thresholds to use based on
 the earthquake magnitude.  There are 4 earthquake values that may be
 defined in the COSMOS header, and the order for selection is moment,
 local, surface, and other.
 There is a second check to ensure that the sampling rate is sufficient for
 the earthquake magnitude.  These are the minimum sampling rates and
 magnitudes:
 EQ mag(magnitude)       flc(HZ)     fhc(HZ)  Nyquist f(Hz)  min samp (samp/sec)
 magnitude(ge)5.5        0.1         40       50                  100
 3.5(le)magnitude(lt)5.5 0.3         35       45                  90
 magnitude(lt)3.5        0.5         25       30                  60</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>intype</code> - earthquake source value determined from the cosmos header</dd>
<dd><code>mag</code> - magnitude for the given type from the header</dd>
<dd><code>orig_samprate</code> - original (not resampled) sample rate of the input waveform</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the same magnitude type, updated to LOWSPS if needed</dd>
</dl>
</li>
</ul>
<a name="findFreqThresholds-double:A-int-double-double-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>findFreqThresholds</h4>
<pre>public&nbsp;void&nbsp;findFreqThresholds(double[]&nbsp;array,
                               int&nbsp;eonset,
                               double&nbsp;current_samprate,
                               double&nbsp;orig_samprate)</pre>
<div class="block">Looks at the smoothed frequency content for the acceleration array
 and uses this to determine the filter cutoff thresholds.  This is accomplished
 by comparing the frequency signature of the entire acceleration array with
 the signature of just the noise portion (from the start of the array to 
 the even onset).  The algorithm looks for the intersection of these 2 signatures
 between the instrument characteristic frequency and the nyquist frequency 
 for the high cutoff frequency, and between 0.1 Hz and 1 Hz for the low cutoff frequency.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>array</code> - acceleration array for frequency calculation</dd>
<dd><code>eonset</code> - event onset index in acceleration array</dd>
<dd><code>current_samprate</code> - current sampling rate if record has been resampled</dd>
<dd><code>orig_samprate</code> - original sampling rate of the record</dd>
</dl>
</li>
</ul>
<a name="smoothFAS-double:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>smoothFAS</h4>
<pre>public&nbsp;double[]&nbsp;smoothFAS(double[]&nbsp;FASamps)</pre>
<div class="block">Uses the Konno-Ohmachi window function to smooth the Fourier amplitude
 spectra.
 
 Based on Matlab code written by: Dr. Erol Kalkan, P.E. (kalkan76@gmail.com)
 Revision 1.0.0  Date: 2019/20/06</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>FASamps</code> - input Fourier amplitude spectrum to smooth</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the smoothed array</dd>
</dl>
</li>
</ul>
<a name="findIntersection-double:A-double:A-double:A-double:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>findIntersection</h4>
<pre>public&nbsp;org.apache.commons.math3.linear.RealMatrix&nbsp;findIntersection(double[]&nbsp;x1,
                                                                   double[]&nbsp;y1,
                                                                   double[]&nbsp;x2,
                                                                   double[]&nbsp;y2)</pre>
<div class="block">Finds the intersection of 2 curves.  Adapted from curve - intersections - InterX.m
 written by NS, available at
 https://www.mathworks.com/matlabcentral/fileexchange/22441-curve-intersections
 Based on matlab code by: Dr. Erol Kalkan, P.E. (kalkan76@gmail.com)</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>x1</code> - x (independent) values for first curve</dd>
<dd><code>y1</code> - y (dependent) values for first curve</dd>
<dd><code>x2</code> - x values for 2nd curve</dd>
<dd><code>y2</code> - y values for 2nd curve</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a matrix containing the x,y intersection pairs, with the x
 values in row 0 and the corresponding y values in row 1</dd>
</dl>
</li>
</ul>
<a name="getLowCutOff--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLowCutOff</h4>
<pre>public&nbsp;double&nbsp;getLowCutOff()</pre>
<div class="block">Getter for the filter low cutoff threshold</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the low cutoff threshold</dd>
</dl>
</li>
</ul>
<a name="getHighCutOff--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getHighCutOff</h4>
<pre>public&nbsp;double&nbsp;getHighCutOff()</pre>
<div class="block">Getter for the filter high cutoff threshold</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the high cutoff threshold</dd>
</dl>
</li>
</ul>
<a name="getMagnitude--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getMagnitude</h4>
<pre>public&nbsp;double&nbsp;getMagnitude()</pre>
<div class="block">Getter for the earthquake magnitude used for selection</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the earthquake magnitude</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/FilterCutOffThresholds.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-files/index-1.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../SmProcessing/FilterAndIntegrateProcess.html" title="class in SmProcessing"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../SmProcessing/QCcheck.html" title="class in SmProcessing"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../index.html?SmProcessing/FilterCutOffThresholds.html" target="_top">Frames</a></li>
<li><a href="FilterCutOffThresholds.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
